"use strict";angular.module("endslaverynowApp",["env","firebase","ngAnimate","ngCookies","ngFileUpload","ngResource","ngRoute","ngSanitize","ngTouch","ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("/",{url:"/",templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).state("about",{url:"/about",templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).state("admin.add",{url:"/add",templateUrl:"views/admin.formAdd.html",controller:"FormAddCtrl",controllerAs:"formAdd",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}).state("brand",{url:"/brand/:id",templateUrl:"views/brand.html",controller:"BrandCtrl",controllerAs:"brand"}).state("admin",{url:"/admin",templateUrl:"views/admin.html",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn()}]}}).state("admin.editCategories",{url:"/editCategories",templateUrl:"views/admin.editCategories.html",controller:"EditCategoriesCtrl",controllerAs:"editCategories",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}).state("admin.editBrands",{url:"/editBrands",templateUrl:"views/admin.editBrands.html",controller:"EditBrandsCtrl",controllerAs:"editBrands",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}).state("admin.editProducts",{url:"/editProducts",templateUrl:"views/admin.editProducts.html",controller:"EditProductsCtrl",controllerAs:"editProducts",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}).state("admin.editCategory",{url:"/editCategory/:id",templateUrl:"views/admin.editCategory.html",controller:"EditCategoryCtrl",controllerAs:"editCategory",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}).state("categories",{url:"/categories",templateUrl:"views/categories.html",controller:"CategoriesCtrl",controllerAs:"categories"}).state("category",{url:"/category/:id",templateUrl:"views/category.html",controller:"CategoryCtrl",controllerAs:"category"}).state("certifications",{url:"/certifications",templateUrl:"views/certifications.html",controller:"CertificationsCtrl",controllerAs:"certifications"}).state("admin.editBrand",{url:"/editBrand/:id",templateUrl:"views/admin.editBrand.html",controller:"EditBrandCtrl",controllerAs:"editBrand",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}).state("admin.editProduct",{url:"/editProduct/:id",templateUrl:"views/admin.editProduct.html",controller:"EditProductCtrl",controllerAs:"editProduct",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}).state("login",{url:"/login",templateUrl:"views/login.html",controller:"SessionsCtrl",controllerAs:"sessions"}).state("admin.users",{url:"/users",templateUrl:"views/admin.users.html",controller:"UsersCtrl",controllerAs:"users",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}).state("product",{url:"/product/:id",templateUrl:"views/product.html",controller:"ProductCtrl",controllerAs:"product"}).state("rankings",{url:"/rankings",templateUrl:"views/rankings.html",controller:"RankingsCtrl",controllerAs:"rankings"}).state("admin.auditLogReport",{url:"/auditLogReport",templateUrl:"views/auditLog/admin.auditLogReport.html",controller:"AuditLogReportCtrl",controllerAs:"auditLogReport",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn}]}}),b.otherwise("/")}]).factory("Auth",["$firebaseAuth",function(a){return a()}]).factory("dataRepositoryFactory",["$firebaseObject","$firebaseArray",function(a,b){return new DataRepositoryFactory(a,b)}]).run(["$rootScope","$transitions","$state","ENV",function(a,b,c,d){var e={apiKey:d.firebase.apiKey,authDomain:d.firebase.authDomain,databaseURL:d.firebase.databaseURL,projectId:d.firebase.projectId,storageBucket:d.firebase.storageBucket,messagingSenderId:d.firebase.messagingSenderId};firebase.apps.length||firebase.initializeApp(e),b.onError({},function(a){"AUTH_REQUIRED"===a.error().detail&&c.go("login")}),firebase.auth().onAuthStateChanged(function(b){b?a.currentUser=b:a.currentUser=null})}]),angular.module("endslaverynowApp").controller("MainCtrl",["$scope","dataRepositoryFactory",function(a,b){a.categories=[],b.ready(function(){a.categories=b.getDataRepository().getTopLevelCategories(),a.loaded=!0})}]),angular.module("endslaverynowApp").controller("AboutCtrl",function(){}),angular.module("endslaverynowApp").controller("BrandCtrl",["$transition$","$scope","dataRepositoryFactory",function(a,b,c){b.brandId=a.params().id,b.loaded=!1,b.brandProducts=[],b.relatedCategories=[],c.ready(function(){var a=c.getDataRepository();b.brandDetails=a.getBrandById(b.brandId),null!==b.brandDetails&&(b.brandProducts=a.getBrandProductsForBrand(b.brandDetails),b.relatedCategories=a.getRelatedCategoriesForBrand(b.brandDetails),b.loaded=!0)})}]),angular.module("endslaverynowApp").controller("CategoryCtrl",["$transition$","$scope","dataRepositoryFactory",function(a,b,c){b.categoryId=a.params().id,b.loaded=!1,b.categoryBrands=[],b.categoryProducts=[],b.relatedCategories=[],c.ready(function(){var a=c.getDataRepository();b.categoryDetails=a.getCategoryById(b.categoryId),null!==b.categoryDetails&&(b.relatedCategories=a.getRelatedCategoriesForCategory(b.categoryDetails),b.categoryBrands=a.getBrandCategoriesForCategory(b.categoryDetails),b.categoryProducts=a.getCategoryProductsForCategory(b.categoryDetails),b.loaded=!0)})}]),angular.module("endslaverynowApp").controller("CategoriesCtrl",["$scope","dataRepositoryFactory",function(a,b){a.loaded=!1,a.allCategories=[],b.ready(function(){a.allCategories=b.getDataRepository().getCategories(),a.loaded=!0})}]),angular.module("endslaverynowApp").controller("CertificationsCtrl",["$scope","dataRepositoryFactory",function(a,b){b.ready(function(){a.certifications=b.getDataRepository().getCertifications(),a.loaded=!0})}]),angular.module("endslaverynowApp").controller("ProductCtrl",["$transition$","$scope","dataRepositoryFactory",function(a,b,c){b.productId=a.params().id,b.productClicked=!1,b.dataRepository=null,c.ready(function(){b.dataRepository=c.getDataRepository(),b.productDetails=b.dataRepository.getProductById(b.productId),null!==b.productDetails&&(b.brandDetails=b.dataRepository.getBrandById(b.productDetails.getBrandId()),b.categoryDetails=b.dataRepository.getCategoryById(b.productDetails.getCategoryId()),b.loaded=!0)}),b.updateClickCount=function(){b.productClicked||null===b.dataRepository||(b.productClicked=!0,b.productDetails.incrementPurchaseUrlClicks(),b.dataRepository.persistProduct(b.productDetails))}}]),angular.module("endslaverynowApp").controller("RankingsCtrl",function(){}),angular.module("endslaverynowApp").controller("FormAddCtrl",["$stateParams","$scope","$state","Upload","dataRepositoryFactory",function(a,b,c,d,e){function f(a){return/^(http)/.test(a)?a:"http://"+a}b.brandId=a.id,b.loaded=!1,b.formType="",b.errorMessage=!1,b.availableTypes={Brands:"brands",Categories:"categories",Products:"products"};var g={categories:{name:"Category",requiredInputs:{name:!0,description:!0,purchaseUrl:!1,image:!0,category:!1,categories:!1,brand:!1,ranking:!1,parentCategoryId:!1}},brands:{name:"Brand",requiredInputs:{name:!0,description:!0,purchaseUrl:!1,image:!0,category:!1,categories:!0,brand:!1,ranking:!0}},products:{name:"Product",requiredInputs:{name:!0,description:!0,purchaseUrl:!0,image:!0,categoryId:!0,brandId:!0,ranking:!1,parentCategoryId:!1}}};b.rankingOptions=(new Ranking).getRankingOptions(),b.addItem={name:null,description:null,purchaseUrl:null,image:null},b.selectedBrandId=null,b.selectedBrandName=null,b.selectedCategoryId=null,b.selectedCategoryName=null,b.selectedParentCategoryId=null,b.selectedParentCategoryName=null,b.selectedRankName=null,b.products=[],b.dataRepository=null;var h=function(a){return void 0===a?[]:Array.isArray(a)?(a.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0}),a):[a]};e.ready(function(){var a=e.getDataRepository();b.categories=h(a.getCategories().filter(Boolean)),b.brands=h(a.getBrands()),b.products=a.getProducts(),b.dataRepository=a,b.loaded=!0});var i=function(a,b){var c=!!a;for(var d in b)b[d]&&!a[d]&&(c=!1);return c};b.processForm=function(a){if(b.errorMessage=!1,!a)return void(b.errorMessage=!0);var c=null;switch(b.formType){case b.availableTypes.Brands:a.categories=b.selectedCategoryId.toString(),a.ranking=b.selectedRankName,c=new Brand(a);break;case b.availableTypes.Categories:a.parentCategoryId=b.selectedParentCategoryId||0,c=new Category(a);break;case b.availableTypes.Products:a.brandId=b.selectedBrandId,a.categoryId=b.selectedCategoryId,a.purchaseUrl=f(a.purchaseUrl),a.purchaseURlClicks=0,a.parentCategoryId=0,c=new Product(a)}if(i(a,g[b.formType].requiredInputs)){var d=new PersistService(e,b.dataRepository,e.getStorageRepository()),h=function(){var a=document.getElementById("add-form");a.style.display="none";var b=document.getElementById("submitted-form");b.style.display="block"};switch(b.formType){case b.availableTypes.Brands:d.processBrand(c,null,h);break;case b.availableTypes.Categories:d.processCategory(c,null,h);break;case b.availableTypes.Products:d.processProduct(c,null,h)}}else b.errorMessage=!0},b.setCategory=function(a){b.selectedCategoryId=a.getId(),b.selectedCategoryName=a.getName()},b.setParentCategory=function(a){b.selectedParentCategoryId=a.getId(),b.selectedParentCategoryName=a.getName()},b.setBrand=function(a){b.selectedBrandId=a.getId(),b.selectedBrandName=a.getName()},b.setRanking=function(a){b.selectedRankName=a},b.selectItemType=function(a){b.itemType=a?g[a].name:"",b.formType=a},b.reloadPage=function(){c.reload()}}]),angular.module("endslaverynowApp").controller("EditCategoriesCtrl",["$scope","$state","dataRepositoryFactory",function(a,b,c){a.dataRepository=null,a.loaded=!1,a.categories=[],c.ready(function(){a.dataRepository=c.getDataRepository(),a.categories=a.dataRepository.getCategories(),a.loaded=!0}),a.deleteCategory=function(c){var d="Are you sure you want to delete category '"+c.getName()+"'?";window.confirm(d)&&a.dataRepository.deleteCategory(c,function(){window.alert("Category has been deleted"),b.reload()})}}]),angular.module("endslaverynowApp").controller("EditCategoryCtrl",["$transition$","$scope","$state","dataRepositoryFactory",function(a,b,c,d){b.categoryId=a.params().id,b.dataRepository=null,b.categories=[],b.NameValue=null,b.DescriptionValue=null,b.selectedParentCategoryId=null,b.Image=null,d.ready(function(){b.dataRepository=d.getDataRepository(),b.categories=b.dataRepository.getCategories();var a=b.dataRepository.getCategoryById(b.categoryId);b.name=a.getName(),b.description=a.getDescription(),b.parentCategory=b.dataRepository.getCategoryById(a.getParentCategoryId()),b.image=a.getImage(),b.setParentCategory=function(a){b.selectedParentCategoryId=a?a.getId():null,b.selectedParentCategoryName=a?a.getName():null},b.removeParentCategory=function(){b.parentCategory=null,b.setParentCategory(null)}}),b.processForm=function(){var a=b.dataRepository.getCategoryById(b.categoryId);b.NameValue&&a.setName(b.NameValue),b.DescriptionValue&&a.setDescription(b.DescriptionValue),b.selectedParentCategoryId?a.setParentCategoryId(b.selectedParentCategoryId):a.setParentCategoryId(null),b.Image&&a.setImage(d.getStorageRepository().extractLatestImage(b.Image));var e=new PersistService(d,b.dataRepository,d.getStorageRepository());e.processCategory(a,"Edit has been completed!",function(){c.go("admin.editCategories")})}}]),angular.module("endslaverynowApp").controller("EditBrandsCtrl",["$scope","$state","dataRepositoryFactory",function(a,b,c){a.loaded=!1,a.dataRepository=null,a.brands=[],c.ready(function(){a.dataRepository=c.getDataRepository(),a.brands=a.dataRepository.getBrands(),a.loaded=!0}),a.deleteBrand=function(c){var d="Are you sure you want to delete brand '"+c.getName()+"'?";window.confirm(d)&&a.dataRepository.deleteBrand(c,function(){window.alert("Brand has been deleted"),b.reload()})}}]),angular.module("endslaverynowApp").controller("EditBrandCtrl",["$transition$","$scope","$state","dataRepositoryFactory",function(a,b,c,d){b.brandId=a.params().id,b.dataRepository=null,b.brands=[],b.categories=[],b.products=[],b.NameValue=null,b.DescriptionValue=null,b.selectedRankName=null,b.selectedCategoryId=null,b.selectedCategoryName=null,b.Image=null,d.ready(function(){b.dataRepository=d.getDataRepository(),b.brands=b.dataRepository.getBrands(),b.categories=b.dataRepository.getCategories(),b.products=b.dataRepository.getProducts();var a=b.dataRepository.getBrandById(b.brandId);b.name=a.getName(),b.description=a.getDescription(),b.ranking=a.getRanking(),b.image=a.getImage(),b.rankingOptions=(new Ranking).getRankingOptions(),b.CategoryId=a.getFirstCategoryId(),b.cat=null===b.CategoryId?null:b.dataRepository.getCategoryById(b.CategoryId),b.setRanking=function(a){b.selectedRankName=a},b.setCategory=function(a){b.selectedCategoryId=a.getId(),b.selectedCategoryName=a.getName()},b.loaded=!0}),b.processForm=function(){var a=b.dataRepository.getBrandById(b.brandId);b.NameValue&&a.setName(b.NameValue),b.DescriptionValue&&a.setDescription(b.DescriptionValue),b.selectedRankName&&a.setRanking(b.selectedRankName),b.selectedCategoryId&&a.setCategoryIds([b.selectedCategoryId]),b.Image&&a.setImage(d.getStorageRepository().extractLatestImage(b.Image));var e=new PersistService(d,b.dataRepository,d.getStorageRepository());e.processBrand(a,"Edit has been completed!",function(){c.go("admin.editBrands")})}}]),angular.module("endslaverynowApp").controller("SessionsCtrl",["$scope","$rootScope","$state",function(a,b,c){a.loginUser=function(a){firebase.auth().signInWithEmailAndPassword(a.email,a.password).then(function(a){b.currentUser=a,c.go("admin")},function(a){window.alert("Error: "+a.message)})},a.logoutUser=function(){firebase.auth().signOut().then(function(){c.go("login")},function(a){window.alert("Error logging out: "+a)})}}]),angular.module("endslaverynowApp").controller("UsersCtrl",["$scope",function(a){a.createUser=function(a){firebase.auth().createUserWithEmailAndPassword(a.email,a.password).then(function(a){window.alert("Login created for "+a.email),window.location.reload()},function(a){window.alert("Error: "+a.message)})}}]),angular.module("endslaverynowApp").controller("EditProductsCtrl",["$scope","$state","dataRepositoryFactory",function(a,b,c){a.dataRepository=null,a.loaded=!1,a.products=[],c.ready(function(){a.dataRepository=c.getDataRepository(),a.products=a.dataRepository.getProducts(),a.loaded=!0}),a.getNameForBrandId=function(b){if(b){var c=a.dataRepository.getBrandById(b);return c?c.getName():""}return""},a.getNameForCategoryId=function(b){if(b){var c=a.dataRepository.getCategoryById(b);return c?c.getName():""}return""},a.deleteProduct=function(c){var d="Are you sure you want to delete product '"+c.getName()+"'?";window.confirm(d)&&a.dataRepository.deleteProduct(c,function(){window.alert("Product has been deleted"),b.reload()})}}]),angular.module("endslaverynowApp").controller("EditProductCtrl",["$stateParams","$scope","$state","dataRepositoryFactory",function(a,b,c,d){b.productId=a.id,b.dataRepository=null,b.NameValue=null,b.DescriptionValue=null,b.PurchaseURLValue=null,b.selectedCategoryId=null,b.selectedBrandId=null,b.Image=null,d.ready(function(){b.dataRepository=d.getDataRepository(),b.brands=b.dataRepository.getBrands(),b.categories=b.dataRepository.getCategories(),b.products=b.dataRepository.getProducts();var a=b.dataRepository.getProductById(b.productId);b.name=a.getName(),b.description=a.getDescription(),b.ranking=a.getRanking(),b.image=a.getImage(),b.CategoryId=a.getCategoryId(),b.BrandId=a.getBrandId(),b.purchaseURL=a.getPurchaseUrl(),b.brand=b.dataRepository.getBrandById(b.BrandId),b.cat=b.dataRepository.getCategoryById(b.CategoryId),b.loaded=!0,b.setCategory=function(a){b.selectedCategoryId=a.getId(),b.selectedCategoryName=a.getName()},b.setBrand=function(a){b.selectedBrandId=a.getId(),b.selectedBrandName=a.getName()}}),b.processForm=function(){var a=b.dataRepository.getProductById(b.productId);b.NameValue&&a.setName(b.NameValue),b.DescriptionValue&&a.setDescription(b.DescriptionValue),b.PurchaseURLValue&&a.setPurchaseUrl(b.PurchaseURLValue),b.selectedCategoryId&&a.setCategoryId(b.selectedCategoryId),b.selectedBrandId&&a.setBrandId(b.selectedBrandId),b.Image&&a.setImage(d.getStorageRepository().extractLatestImage(b.Image));var e=new PersistService(d,b.dataRepository,d.getStorageRepository());e.processProduct(a,"Edit has been completed!",function(){c.go("admin.editProducts")})}}]);var DataRepositoryFactory=function(a,b){var c=firebase.database();this.syncObject=a(c.ref()),this.recordSets={brands:b(c.ref("brands")),categories:b(c.ref("categories")),products:b(c.ref("products")),auditLog:b(c.ref("auditLog"))},this.dataRepository=null,this.storageRepository=new StorageRepository(firebase),this.ready=function(a){var b=this;this.syncObject.$loaded().then(function(){b.dataRepository=new DataRepository(b.recordSets),a()})},this.getDataRepository=function(){return this.dataRepository},this.getStorageRepository=function(){return this.storageRepository}},StorageRepository=function(a){this.storage=a.storage,this.storageFunc=a.storage(),this.storageRef=this.storageFunc.ref();const b={brand:"Brand",category:"Category",product:"Product"};this.extractLatestImage=function(a){return Array.isArray(a)?[a.pop()]:a},this.getImageUploadFolderNames=function(){return b},this.uploadImageInModel=function(a,b,c){var d={contentType:"image/jpeg"},e=a[0],f=this.storageRef.child(b+"/images/"+e.name).put(e,d);f.on(this.storage.TaskEvent.STATE_CHANGED,function(a){},function(a){switch(a.code){case"storage/bucket_not_found":console.log("The Bucket for this storage could not be found");break;case"storage/unauthorized":console.log("User doesn't have access");break;case"storage/cancelled":console.log("User cancelled the upload process");break;case"storage/unknown":console.log("Unknown error")}},function(){if(c){var a=f.snapshot.downloadURL;c(a)}})}},DataRepository=function(a){this.recordSets=a,this.auditLogger=new AuditLogger(this.recordSets),this.brands=[],this.categories=[],this.products=[];const b={brands:"brands",categories:"categories",products:"products",auditLog:"auditLog"};this.auditLogs=null,this.auditLogHelper=new AuditLogHelper,this.init=function(){this.brands=[],this.categories=[],this.products=[],this.certifications=[];var a=this;this.recordSets.hasOwnProperty(b.brands)&&this.recordSets.brands.forEach(function(b){a.brands.push(new Brand(b))}),this.recordSets.hasOwnProperty(b.categories)&&this.recordSets.categories.forEach(function(b){a.categories.push(new Category(b))}),this.recordSets.hasOwnProperty(b.products)&&this.recordSets.products.forEach(function(b){a.products.push(new Product(b))})},this.init(),this.getBrands=function(){return this.brands},this.getCategories=function(){return this.categories},this.getProducts=function(){return this.products},this.getCertifications=function(){return this.certifications},this.getAuditLogs=function(){if(null===this.auditLogs){this.auditLogs=[];var a=this;this.recordSets.hasOwnProperty(b.auditLog)&&this.recordSets.auditLog.forEach(function(b){a.auditLogs.push(new AuditLog(a.auditLogHelper.fromStorage(b)))}),this.auditLogs.reverse()}return this.auditLogs},this.getTopLevelCategories=function(){return this.categories.filter(function(a){return!a.hasParentCategory()})},this.getCategoryById=function(a){a=parseInt(a);var b=this.categories.filter(function(b){return a===b.getId()});return 1===b.length?b.shift():null},this.getRelatedCategoriesForCategory=function(a){return this.categories.filter(function(b){return a.getParentCategoryId()===b.getId()?!0:a.getId()!==b.getParentCategoryId()&&a.getParentCategoryId()!==b.getParentCategoryId()||a.getId()===b.getId()||0===b.getParentCategoryId()?void 0:!0})},this.getBrandCategoriesForCategory=function(a){return this.brands.filter(function(b){return-1!==b.getCategoryIdAsArray().indexOf(a.getId())})},this.getCategoryProductsForCategory=function(a){return this.products.filter(function(b){return b.getCategoryId()===a.getId()})},this.getBrandById=function(a){a=parseInt(a);var b=this.brands.filter(function(b){return a===b.getId()});return 1===b.length?b.shift():null},this.getBrandProductsForBrand=function(a){return this.products.filter(function(b){return b.getBrandId()===a.getId()})},this.getRelatedCategoriesForBrand=function(a){var b=[],c=this;return a.getCategoryIdAsArray().forEach(function(a){b.push(c.getCategoryById(a))}),b},this.getProductById=function(a){a=parseInt(a);var b=this.products.filter(function(b){return a===b.getId()});return 1===b.length?b.shift():null},this.insert=function(a,b,c,d,e){var f=this;this.recordSets[a].$add(b).then(function(){c&&window.alert(c),d&&d(),f.auditLogger.log(f.auditLogHelper.getAllowedOperationTypes().insert,a,e,null,b)},function(a){window.alert("Error: "+a.toString())})},this.update=function(a,b,c,d,e,f,g){var h=this;this.recordSets[a].$save(b).then(function(){c&&window.alert(c),d&&d(),h.auditLogger.log(h.auditLogHelper.getAllowedOperationTypes().update,a,e,f,g)},function(a){window.alert("Error: "+a.toString())})},this.populateRecordFromBrandModel=function(a,b){a.name=b.getName(),a.description=b.getDescription(),a.categories=b.getCategoryIdAsCsl(),a.image=b.getImage(),a.ranking=b.getRanking()},this.populateRecordFromCategoryModel=function(a,b){a.description=b.getDescription(),a.image=b.getImage(),a.name=b.getName(),a.parentCategoryId=b.getParentCategoryId()},this.populateRecordFromProductModel=function(a,b){a.brandId=b.getBrandId(),a.categoryId=b.getCategoryId(),a.description=b.getDescription(),a.id=b.getId(),a.image=b.getImage(),a.name=b.getName(),a.parentCategoryId=b.getParentCategoryId(),a.purchaseURlClicks=b.getPurchaseUrlClicks(),a.purchaseUrl=b.getPurchaseUrl()},this.persistBrand=function(a,c,d){if(a.hasId()){var e=this.determineIndexFromBrandModel(a),f=this.recordSets.brands[e],g={};angular.copy(f,g),this.populateRecordFromBrandModel(f,a),this.update(b.brands,e,c,d,a.getId(),g,f)}else{a.setId(this.generateNextBrandId());var h={id:a.getId()};this.populateRecordFromBrandModel(h,a),this.insert(b.brands,h,c,d,a.getId())}},this.persistCategory=function(a,c,d){if(a.hasId()){var e=this.determineIndexFromCategoryModel(a),f=this.recordSets.categories[e],g={};angular.copy(f,g),this.populateRecordFromCategoryModel(f,a),this.update(b.categories,e,c,d,a.getId(),g,f)}else{a.setId(this.generateNextCategoryId());var h={id:a.getId()};this.populateRecordFromCategoryModel(h,a),this.insert(b.categories,h,c,d,a.getId())}},this.persistProduct=function(a,c,d){if(a.hasId()){var e=this.determineIndexFromProductModel(a),f=this.recordSets.products[e],g={};angular.copy(f,g),this.populateRecordFromProductModel(f,a),this.update(b.products,e,c,d,a.getId(),g,f)}else{a.setId(this.generateNextProductId());var h={id:a.getId()};this.populateRecordFromProductModel(h,a),this.insert(b.products,h,c,d,a.getId())}},this.generateNextBrandId=function(){var a=0;return this.recordSets.brands.forEach(function(b){a=Math.max(a,b.id)}),++a,a},this.generateNextCategoryId=function(){var a=0;return this.recordSets.categories.forEach(function(b){a=Math.max(a,b.id)}),++a,a},this.generateNextProductId=function(){var a=0;return this.recordSets.products.forEach(function(b){a=Math.max(a,b.id)}),++a,a},this.determineIndexFromBrandModel=function(a){var b=null;return this.recordSets.brands.forEach(function(c,d){c.id===a.getId()&&(b=d)}),b},this.determineIndexFromCategoryModel=function(a){var b=null;return this.recordSets.categories.forEach(function(c,d){c.id===a.getId()&&(b=d)}),b},this.determineIndexFromProductModel=function(a){var b=null;return this.recordSets.products.forEach(function(c,d){c.id===a.getId()&&(b=d)}),b},this.deleteBrand=function(a,c){var d=this,e=this.determineIndexFromBrandModel(a);if(null!==e){var f={};this.populateRecordFromBrandModel(f,a),this.recordSets.brands.$remove(e).then(function(){c(),d.auditLogger.log(d.auditLogHelper.getAllowedOperationTypes()["delete"],b.brands,a.getId(),f,null)})["catch"](function(a){console.log("Error deleting brand: ",a)})}},this.deleteCategory=function(a,c){var d=this,e=this.determineIndexFromCategoryModel(a);if(null!==e){var f={};this.populateRecordFromCategoryModel(f,a),this.recordSets.categories.$remove(e).then(function(){c(),d.auditLogger.log(d.auditLogHelper.getAllowedOperationTypes()["delete"],b.categories,a.getId(),f,null)})["catch"](function(a){console.log("Error deleting category: ",a)})}},this.deleteProduct=function(a,c){var d=this,e=this.determineIndexFromProductModel(a);if(null!==e){var f={};this.populateRecordFromProductModel(f,a),this.recordSets.products.$remove(e).then(function(){c(),d.auditLogger.log(d.auditLogHelper.getAllowedOperationTypes()["delete"],b.products,a.getId(),f,null)})["catch"](function(a){console.log("Error deleting product: ",a)})}}},PersistService=function(a,b,c){this.dataRepository=b,this.storageRepository=c,this.processBrand=function(a,b,c){var d=a,e=this,f=function(){e.dataRepository.persistBrand(d,b,c)};d.imageRequiresUploading()?this.storageRepository.uploadImageInModel(d.getImage(),this.storageRepository.getImageUploadFolderNames().brand,function(a){d.setImage(a),f()}):f()},this.processCategory=function(a,b,c){var d=a,e=this,f=function(){e.dataRepository.persistCategory(d,b,c)};d.imageRequiresUploading()?this.storageRepository.uploadImageInModel(d.getImage(),this.storageRepository.getImageUploadFolderNames().category,function(a){d.setImage(a),f()}):f()},this.processProduct=function(a,b,c){var d=a,e=this,f=function(){e.dataRepository.persistProduct(d,b,c)};d.imageRequiresUploading()?this.storageRepository.uploadImageInModel(d.getImage(),this.storageRepository.getImageUploadFolderNames().product,function(a){d.setImage(a),f()}):f()}},Brand=function(){var a=function(a){this.categoryIdsCsl=a.hasOwnProperty("categories")?a.categories:null,this.description=a.hasOwnProperty("description")?a.description:null,this.id=a.hasOwnProperty("id")?parseInt(a.id):null,this.image=a.hasOwnProperty("image")?a.image:null,this.name=a.hasOwnProperty("name")?a.name:null,this.ranking=a.hasOwnProperty("ranking")?a.ranking:null,this.brandUrl=null,this.categoryIds=null===this.categoryIdsCsl?[]:String(this.categoryIdsCsl).split(",")};return a.prototype={getId:function(){return this.id},hasId:function(){return null!==this.id},setId:function(a){this.id=a},getName:function(){return this.name},hasName:function(){return null!==this.name},setName:function(a){this.name=a},getImage:function(){return this.image},hasImage:function(){return null!==this.image},setImage:function(a){this.image=a},imageRequiresUploading:function(){return Array.isArray(this.image)&&1===this.image.length},getCategoryIdAsArray:function(){return this.categoryIds},getCategoryIdAsCsl:function(){return this.categoryIds.join(",")},getFirstCategoryId:function(){return this.categoryIds.length?this.categoryIds[0]:null},setCategoryIds:function(a){this.categoryIds=a},getRanking:function(){return this.ranking},hasRanking:function(){return null!==this.ranking},setRanking:function(a){this.ranking=a},getDescription:function(){return this.description},hasDescription:function(){return null!==this.description},setDescription:function(a){this.description=a},getBrandURL:function(){return this.brandUrl},hasBrandURL:function(){return null!==this.brandUrl}},a}(),Certification=function(){var a=function(a){this.description=a.hasOwnProperty("description")?a.description:null,this.image=a.hasOwnProperty("image")?a.image:null,this.name=a.hasOwnProperty("name")?a.name:null};return a.prototype={getName:function(){return this.name},getDescription:function(){return this.description},hasImage:function(){return null!==this.image},getImage:function(){return this.image}},a}(),Category=function(){var a=function(a){this.description=a.hasOwnProperty("description")?a.description:null,this.id=a.hasOwnProperty("id")?parseInt(a.id):null,this.image=a.hasOwnProperty("image")?a.image:null,this.name=a.hasOwnProperty("name")?a.name:null,this.parentCategoryId=a.hasOwnProperty("parentCategoryId")?parseInt(a.parentCategoryId):null};return a.prototype={getId:function(){return this.id},hasId:function(){return null!==this.id},setId:function(a){this.id=a},getName:function(){return this.name},hasName:function(){return null!==this.name},setName:function(a){this.name=a},getDescription:function(){return this.description},setDescription:function(a){this.description=a},getImage:function(){return this.image},hasImage:function(){return null!==this.image},setImage:function(a){this.image=a},imageRequiresUploading:function(){return Array.isArray(this.image)&&1===this.image.length},getParentCategoryId:function(){return this.parentCategoryId},hasParentCategory:function(){return this.getParentCategoryId()>0},setParentCategoryId:function(a){this.parentCategoryId=a}},a}(),Product=function(){var a=function(a){this.brandId=a.hasOwnProperty("brandId")?parseInt(a.brandId):null,this.categoryId=a.hasOwnProperty("categoryId")?parseInt(a.categoryId):null,this.description=a.hasOwnProperty("description")?a.description:null,this.id=a.hasOwnProperty("id")?parseInt(a.id):null,this.image=a.hasOwnProperty("image")?a.image:null,this.name=a.hasOwnProperty("name")?a.name:null,this.parentCategoryId=a.hasOwnProperty("parentCategoryId")?parseInt(a.parentCategoryId):null,this.purchaseURlClicks=a.hasOwnProperty("purchaseURlClicks")?a.purchaseURlClicks:null,this.purchaseUrl=a.hasOwnProperty("purchaseUrl")?a.purchaseUrl:null,this.$$hashKey=a.hasOwnProperty("$$hashKey")?a.$$hashKey:null};return a.prototype={getId:function(){return this.id},hasId:function(){return null!==this.id},setId:function(a){this.id=a},getName:function(){return this.name},setName:function(a){this.name=a},getImage:function(){return this.image},hasImage:function(){return null!==this.image},setImage:function(a){this.image=a},imageRequiresUploading:function(){return Array.isArray(this.image)&&1===this.image.length},getCategoryId:function(){return this.categoryId},setCategoryId:function(a){this.categoryId=a},getBrandId:function(){return this.brandId},setBrandId:function(a){this.brandId=a},getPurchaseUrl:function(){return this.purchaseUrl},hasPurchaseUrl:function(){return null!==this.purchaseUrl},setPurchaseUrl:function(a){this.purchaseUrl=a},incrementPurchaseUrlClicks:function(){++this.purchaseURlClicks},getPurchaseUrlClicks:function(){return this.purchaseURlClicks},getDescription:function(){return this.description},setDescription:function(a){this.description=a},getParentCategoryId:function(){return this.parentCategoryId},getRanking:function(){return null}},a}(),Ranking=function(){var a=function(a){};return a.prototype={getRankingOptions:function(){return{good:"Good",better:"Better",best:"Best"}}},a}();angular.module("env",[]).constant("ENV",{firebase:{apiKey:"AIzaSyD9_sUa5MnIA0CxsO44Oofd5_7y-j45SXg",authDomain:"end-slavery-now.firebaseapp.com",databaseURL:"https://end-slavery-now.firebaseio.com",messagingSenderId:"48416679514",projectId:"end-slavery-now.appspot.com",storageBucket:"end-slavery-now.appspot.com"}});var AuditLog=function(){var a=function(a){this.loggerVersion=1,this.userType=a.hasOwnProperty("userType")?a.userType:null,this.userRef=a.hasOwnProperty("userRef")?a.userRef:null,this.operationType=a.hasOwnProperty("operationType")?a.operationType:null,this.dateTime=a.hasOwnProperty("dateTime")?a.dateTime:new Date,this.recordType=a.hasOwnProperty("recordType")?a.recordType:null,this.recordId=a.hasOwnProperty("recordId")?a.recordId:null,this.changedValues=a.hasOwnProperty("changedValues")?a.changedValues:null;var b=new AuditLogHelper;!b.isValidUserType(this.userType),!b.isValidOperationType(this.operationType),null===this.changedValues};return a.prototype={toStorageRecord:function(){return{loggerVersion:this.loggerVersion,userType:this.userType,userRef:this.userRef,operationType:this.operationType,dateTimeUtc:this.dateTime.toISOString(),recordType:this.recordType,recordId:this.recordId,changedValues:this.changedValues.map(function(a){return a.toStorageRecord()})}}},a}(),AuditLogChangedValue=function(){
var a=function(a,b,c){this.recordProperty=a,this.previousValue=b,this.currentValue=c,this.valueMatchesProperty=function(a,b){return"string"==typeof a?-1!==a.toLowerCase().indexOf(b.toLowerCase()):"number"==typeof a?a.toString()===b:!1}};return a.prototype={toStorageRecord:function(){return{property:this.recordProperty,previous:this.previousValue,current:this.currentValue}},previousValueMatches:function(a){return this.valueMatchesProperty(this.previousValue,a)},currentValueMatches:function(a){return this.valueMatchesProperty(this.currentValue,a)}},a}(),ResultColumn=function(){var a=function(a,b,c,d){this.columnType=a,this.columnHeading=b,this.recordType=c,this.propertyName=d,this.columnsSpanningTwoRows=["visitRecord","datetime","user","operation","recordType","recordId"],this.buildExternalRecordLinkAnchor=function(a,b,c){var d="unknown";switch(a){case"brands":d="editBrand";break;case"categories":d="editCategory";break;case"products":d="editProduct"}var e="";return null!==c&&(e='<a href="/#!/admin/'+d+"/"+b+'" target="_blank">Go</a>'),e},this.buildExternalRecordLinkCell=function(a,b,c){var d="Unknown";switch(a){case"brands":d="Brand";break;case"categories":d="Category";break;case"products":d="Product"}var e=d+": "+(null===c?"[deleted]":c.getName()),f=this.buildExternalRecordLinkAnchor(a,b,c),g='<span title="'+e+'">'+b+(""===f?"":" "+f)+"</span>";return g}};return a.prototype={getHeading:function(){return this.columnHeading},spansTwoRows:function(){return-1!==this.columnsSpanningTwoRows.indexOf(this.columnType)},getRowSpan:function(a){return a&&this.spansTwoRows()?2:1},getClass:function(){return"datetime"===this.columnType?"no-wrap":null},isCellDisplayed:function(a){return a||!this.spansTwoRows()},getDisplayValue:function(a,b,c){if(this.spansTwoRows())switch(this.columnType){case"visitRecord":var d=a.recordType,e=a.recordId,f=null;switch(d){case"brands":f=c.getBrandById(e);break;case"categories":f=c.getCategoryById(e);break;case"products":f=c.getProductById(e)}return this.buildExternalRecordLinkAnchor(d,e,f);case"datetime":var g=new moment(a.dateTime);return g.format("DD-MMM-YYYY")+"<br/>"+g.format("HH:mm:ss");case"user":return"anonymous"===a.userType?"(anonymous)":a.userRef;case"operation":return a.operationType;case"recordType":return a.recordType;case"recordId":return a.recordId;default:return"[Unknown column type]"}if(this.recordType!==a.recordType)return null;var h=this,i=a.changedValues.filter(function(a){return a.recordProperty===h.propertyName});if(1!==i.length)return null;var j=b?i[0].currentValue:i[0].previousValue;if(null!==j)switch(i[0].recordProperty){case"image":j='<img src="'+j+'"/>';break;case"purchaseUrl":j='<a href="'+j+'" target="_blank">'+j+"</a>";break;case"categoryId":case"parentCategoryId":if(j>0){var k=c.getCategoryById(j);j=this.buildExternalRecordLinkCell("categories",j,k)}break;case"brandId":if(j>0){var l=c.getBrandById(j);j=this.buildExternalRecordLinkCell("brands",j,l)}}return j=null===j?"[NULL]":j}},a}(),AuditLogFilterer=function(){this.auditLogHelper=new AuditLogHelper,this.userTypes=this.auditLogHelper.getAllowedUserTypes(),this.generateFilters=function(a){var b={users:{admins:[],anon:!1},operationTypes:[],dates:{min:null,max:null},records:{}},c=this;a.forEach(function(a){a.userType===c.userTypes.admin?-1===b.users.admins.indexOf(a.userRef)&&b.users.admins.push(a.userRef):b.users.anon=!0,-1===b.operationTypes.indexOf(a.operationType)&&b.operationTypes.push(a.operationType),(null===b.dates.min||b.dates.min>a.dateTime)&&(b.dates.min=a.dateTime),(null===b.dates.max||b.dates.max<a.dateTime)&&(b.dates.max=a.dateTime),b.records.hasOwnProperty(a.recordType)||(b.records[a.recordType]={columns:[],ids:[]}),a.changedValues.forEach(function(c){-1===b.records[a.recordType].columns.indexOf(c.recordProperty)&&b.records[a.recordType].columns.push(c.recordProperty)}),-1===b.records[a.recordType].ids.indexOf(a.recordId)&&b.records[a.recordType].ids.push(a.recordId)}),b.users.admins.sort(),b.operationTypes.sort();var d={};return Object.keys(b.records).sort().forEach(function(a){d[a]=b.records[a],d[a].columns.sort(),d[a].ids.sort()}),b.records=d,b},this.toAdminUser=function(a){return 0===a.indexOf("admin$")?a.substr(6):a},this.applyFilter=function(a,b){var c=this,d=a.filter(function(a){if(null!==b.user)if("anonymous"===b.user){if(a.userType!==c.userTypes.anonymous)return!1}else if(a.userType!==c.userTypes.admin||"any-admin"!==b.user&&c.toAdminUser(b.user)!==a.userRef)return!1;if(null!==b.operationType&&a.operationType!==b.operationType)return!1;if(null!==b.dates.from&&a.dateTime<b.dates.from)return!1;if(null!==b.dates.to&&a.dateTime>b.dates.to)return!1;if(null!==b.record.type){if(a.recordType!==b.record.type)return!1;if(null!==b.record.id&&a.recordId!==parseInt(b.record.id))return!1;if(null!==b.record.column){var d=a.changedValues.filter(function(a){return a.recordProperty===b.record.column});if(0===d.length)return!1}}if(null!==b.field.value){var e=a.changedValues.filter(function(a){return("from"===b.field.transition||"either"===b.field.transition)&&a.previousValueMatches(b.field.value)||("to"===b.field.transition||"either"===b.field.transition)&&a.currentValueMatches(b.field.value)?null!==b.record.column&&a.recordProperty!==b.record.column?!1:!0:!1});if(0===e.length)return!1}return!0});return d},this.addChangedColumns=function(a,b){var c={};a.forEach(function(a){c.hasOwnProperty(a.recordType)||(c[a.recordType]={}),a.changedValues.forEach(function(b){c[a.recordType].hasOwnProperty(b.recordProperty)||(c[a.recordType][b.recordProperty]=!0)})});var d=new ResultColumnHelper;for(var e in c)if(c.hasOwnProperty(e))for(var f in c[e])c[e].hasOwnProperty(f)&&b.push(d.makeColumn(e,f))}},AuditLogger=function(a){const b="auditLog";this.recordSets=a,this.auditLogHelper=new AuditLogHelper,this.log=function(a,c,d,e,f){var g=[];switch(a){case this.auditLogHelper.getAllowedOperationTypes().insert:g=this.buildChangedValuesForInsert(f);break;case this.auditLogHelper.getAllowedOperationTypes().update:g=this.buildChangedValuesForUpdate(e,f);break;case this.auditLogHelper.getAllowedOperationTypes()["delete"]:g=this.buildChangedValuesForDelete(e)}if(0!==g.length){var h=firebase.auth().currentUser,i={userType:h?"admin":"anonymous",userRef:h?h.email:null,operationType:a,recordType:c,recordId:d,changedValues:g},j=new AuditLog(i);this.recordSets[b].$add(j.toStorageRecord()).then(function(){console.log("Info: Audit log saved successfully")},function(a){console.log("Info: Audit log save produced an error:",a)})}},this.buildChangedValuesForInsert=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&null!==a[c]&&b.push(new AuditLogChangedValue(c,null,a[c]));return b},this.buildChangedValuesForUpdate=function(a,b){var c=[],d=null,e=null;for(var f in b)b.hasOwnProperty(f)&&(d=a.hasOwnProperty(f)?a[f]:null,e=b[f],e!==d&&c.push(new AuditLogChangedValue(f,d,e)));for(f in a)a.hasOwnProperty(f)&&!b.hasOwnProperty(f)&&(d=a[f],e=null,e!==d&&c.push(new AuditLogChangedValue(f,d,e)));return c},this.buildChangedValuesForDelete=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&null!==a[c]&&b.push(new AuditLogChangedValue(c,a[c],null));return b}},AuditLogHelper=function(){this.getAllowedUserTypes=function(){return{admin:"admin",anonymous:"anonymous"}},this.getAllowedOperationTypes=function(){return{insert:"insert",update:"update","delete":"delete"}},this.isValidUserType=function(a){return this.contains(a,this.getAllowedUserTypes())},this.isValidOperationType=function(a){return this.contains(a,this.getAllowedOperationTypes())},this.contains=function(a,b){for(var c in b)if(b.hasOwnProperty(c)&&b[c]===a)return!0},this.fromStorage=function(a){var b=[];if(a.hasOwnProperty("changedValues")&&Array.isArray(a.changedValues))for(var c=0;c<a.changedValues.length;c++){var d=a.changedValues[c];b.push(new AuditLogChangedValue(d.hasOwnProperty("property")?d.property:null,d.hasOwnProperty("previous")?d.previous:null,d.hasOwnProperty("current")?d.current:null))}return{loggerVersion:a.hasOwnProperty("loggerVersion")?a.loggerVersion:0,userType:a.hasOwnProperty("userType")?a.userType:null,userRef:a.hasOwnProperty("userRef")?a.userRef:null,operationType:a.hasOwnProperty("operationType")?a.operationType:null,dateTime:a.hasOwnProperty("dateTimeUtc")?new Date(a.dateTimeUtc):null,recordType:a.hasOwnProperty("recordType")?a.recordType:null,recordId:a.hasOwnProperty("recordId")?a.recordId:null,changedValues:b}}},ResultColumnHelper=function(){this.makeVisitRecord=function(){return new ResultColumn("visitRecord","Go")},this.makeDatetime=function(){return new ResultColumn("datetime","Date/Time")},this.makeUser=function(){return new ResultColumn("user","User")},this.makeOperation=function(){return new ResultColumn("operation","Operation")},this.makeRecordType=function(){return new ResultColumn("recordType","Record Type")},this.makeRecordId=function(){return new ResultColumn("recordId","Record Id")},this.makeColumn=function(a,b){return new ResultColumn("column",a+":<br/>"+b,a,b)}};angular.module("endslaverynowApp").controller("AuditLogReportCtrl",["$scope","$location","dataRepositoryFactory",function(a,b,c){a.auditLogFilterer=new AuditLogFilterer,a.resultColumnHelper=new ResultColumnHelper,a.$location=b,a.showFilters=!0,a.resultColumns=[],a.results=[],a.auditLogs=null,a.criteria={user:null,operationType:null,dates:{from:null,to:null},record:{type:null,id:null,column:null},field:{value:null,transition:"either"}},a.noFilter=!0,c.ready(function(){a.dataRepository=c.getDataRepository(),a.auditLogs=a.dataRepository.getAuditLogs(),a.filters=a.auditLogFilterer.generateFilters(a.auditLogs),a.defaultFilters()}),a.defaultFilters=function(){var b=a.$location.search();if(b.hasOwnProperty("recordType")&&b.hasOwnProperty("recordId")){var c=!1;if(a.filters.records.hasOwnProperty(b.recordType)){var d=parseInt(b.recordId);-1!==a.filters.records[b.recordType].ids.indexOf(d)&&(a.criteria.record.type=b.recordType,a.criteria.record.id=d.toString(),c=!0,a.refreshResults())}c||window.alert("Sorry, there is no history for that record")}},a.toggleShowFilter=function(){a.showFilters=!a.showFilters},a.buildFilterLimitDate=function(a,b){var c=new moment(a);return b?c.set({hour:0,minute:0,second:0,millisecond:0}):c.set({hour:23,minute:59,second:59,millisecond:999}),c},a.getEarliestFilterDate=function(b){return a.filters?this.buildFilterLimitDate(a.filters.dates.min,b):!1},a.getLatestFilterDate=function(b){return a.filters?this.buildFilterLimitDate(a.filters.dates.max,b):!1},a.clearRecordSubFilters=function(){a.criteria.record.id=null,a.criteria.record.column=null},a.refreshResults=function d(b){b===!0&&a.$apply(d(!1)),a.sanitiseCriteria(a.criteria),a.noFilter=!a.anyCriteria(),a.results=[],a.resultColumns=[],null===a.criteria.dates.from||a.criteria.dates.from instanceof moment||(a.criteria.dates.from=new moment(a.criteria.dates.from,"DD-MMM-YYYY HH:mm:ss")),null===a.criteria.dates.to||a.criteria.dates.to instanceof moment||(a.criteria.dates.to=new moment(a.criteria.dates.to,"DD-MMM-YYYY HH:mm:ss")),null!==a.criteria.dates.from&&null!==a.criteria.dates.to&&a.criteria.dates.from.isAfter(a.criteria.dates.to)&&(a.noFilter=!0),a.noFilter||(a.results=a.auditLogFilterer.applyFilter(a.auditLogs,a.criteria),0!==a.results.length&&(a.resultColumns.push(a.resultColumnHelper.makeVisitRecord()),a.resultColumns.push(a.resultColumnHelper.makeDatetime()),(null===a.criteria.user||"any-admin"===a.criteria.user)&&a.resultColumns.push(a.resultColumnHelper.makeUser()),null===a.criteria.operationType&&a.resultColumns.push(a.resultColumnHelper.makeOperation()),null===a.criteria.record.type&&a.resultColumns.push(a.resultColumnHelper.makeRecordType()),null===a.criteria.record.id&&a.resultColumns.push(a.resultColumnHelper.makeRecordId()),a.auditLogFilterer.addChangedColumns(a.results,a.resultColumns)))},a.sanitiseCriteria=function(b){for(var c in b)b.hasOwnProperty(c)&&(""===b[c]?b[c]=null:null!==b[c]&&"object"==typeof b[c]&&a.sanitiseCriteria(b[c]))},a.anyCriteria=function(){return null!==a.criteria.user||null!==a.criteria.operationType||null!==a.criteria.dates.from||null!==a.criteria.dates.to||null!==a.criteria.record.type||null!==a.criteria.record.id||null!==a.criteria.record.column||null!==a.criteria.field.value||"either"!==a.criteria.field.transition}}]),angular.module("endslaverynowApp").run(["$templateCache",function(a){a.put("views/about.html",'<h2>Slave Free Buying Guide</h2> <p>The Slave Free Buying Guide is meant to introduce consumers to companies, brands and social enterprises that address slavery, forced labor and human trafficking in their supply chains. End Slavery Now researched antislavery policies; supply chains; third-party certifications; prevalence studies in specific industries; and companies’ engagement surrounding slavery, forced labor and human trafficking in order to develop a list of products that you can begin purchasing in lieu of other options.</p> <p>At End Slavery Now we recognize that the best companies are those that put ethical concerns and social responsibility at the top of their agendas. Fortunately, more and more companies care about broader social issues, including the environment and poverty. For this guide, we’ve narrowed our focus to companies, brands and products that specifically address forced labor, slavery and/or human trafficking. In addition to recommending innovative brands that clearly lead the way when it comes to prioritizing slavery-free goods, we’ve also included traditional companies that are beginning to produce specific goods or product lines without the use of child labor, forced labor or other forms of slave labor. Importantly, much of this recent antislavery effort by traditional companies is a direct response to consumer demands for such products. By highlighting some of the best brands and the positive changes towards slavery-free products, this guide is a tool for those wanting to choose better products.</p> <h2>How You Can Help</h2> <p>The End Slavery Now Slave Free Buying Guide is divided into sections based on product type. Most sections include: <ul> <li>A brief explanation of slavery in that particular industry or product chain</li> <li>Individual product recommendations, so you know which products you can purchase</li> <li>Company rankings in Good, Better and Best categories based on their antislavery policies, supply chain transparency, third-party certifications and engagement</li> </ul> </p> <p>One of the most impactful ways normal, everyday people can get involved in the fight against modern-day slavery and human trafficking is to begin purchasing slavery-free goods. When scaled, these purchases create demand for goods produced with audited, slavery-free labor; simultaneously, this shift also shrinks the market for goods produced with forced or slave labor and/or by trafficked humans.</p> <h2>Contact Us</h2> <p>If you need immediate help, contact the human trafficking hotline number 1-888-373-7888. Other countries: Search hotlines in your country <a href="http://globalmodernslavery.org/" target="_blank">here</a>.<br> For other requests or for more information, please email <a href="mailto:info@endslaverynow.org">info@endslaverynow.org</a></p> <h2>Donations</h2> <p>You may donate online through our parent organization, National Underground Railroad Freedom Center. Please write "End Slavery Now" in the memo box.</p> <p>If mailing a check directly to our offices, please send donations to:<br><br> End Slavery Now<br> National Underground Railroad Freedom Center<br> 50 E. Freedom Way Cincinnati,<br> Ohio 45202 USA</p>'),a.put("views/admin.editBrand.html",'<div> <br> <div class="add-form" id="add-form"> <h2>Edit Brand</h2> <div class="form-group"> Name : <input type="text" class="form-control" rows="5" ng-value="name" ng-model="NameValue" required> </div> <div class="form-group"> Description: <textarea type="textarea" class="form-control" rows="5" ng-value="description" placeholder="Description" ng-model="DescriptionValue" required></textarea> </div> <div class="form-group"> Image: <img ng-if="!image" src="images/noimage.3b3d88bc.png" height="100px"> <img ng-if="image" ng-src="{{ image }}" height="100px"> <input id="pictures" type="submit" ngf-select ng-model="Image" name="file" value="Edit Image" accept="image/*" ngf-max-size="2MB" ngf-keep="true" ngf-keep-distinct="true" class="btn image-upload" required> </div> <div class="form-group"> Ranking: <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedRankName || ranking}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="rank in rankingOptions" ng-if="rank.length > 0" ng-click="setRanking(rank)" class="dropdown-item form-control">{{rank}}</button> </div> </div> <div class="form-group"> Category: <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedCategoryName || cat.name}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="category in categories" ng-if="category.getName().length > 0" ng-click="setCategory(category)" class="dropdown-item form-control">{{category.getName()}}</button> </div> </div> <div class="errorMessage" ng-if="errorMessage">Error submitting form. Please complete all fields to continue. <br> <br> </div> <input class="btn btn-primary btn-lg btn-block" type="submit" ng-click="processForm()" value="Submit"> </div> </div>'),a.put("views/admin.editBrands.html",'<table class="table"> <thead> <tr> <th scope="col">Images</th> <th scope="col">Brands</th> <th scope="col">Ranking</th> <th scope="col">Description </th> <th scope="col">Action</th> </tr> </thead> <tbody> <tr ng-repeat="brand in brands"> <td> <img ng-if="!brand.hasImage()" src="images/noimage.3b3d88bc.png" height="50px"> <img ng-if="brand.hasImage()" ng-src="{{ brand.getImage() }}" height="50px"> </td> <td>{{brand.getName()}}</td> <td>{{brand.getRanking()}}</td> <td>{{brand.getDescription()}}</td> <td class="action"> <button type="button" class="btn btn-success"> <a href="#!/admin/editBrand/{{ brand.getId() }}">Edit</a> </button> <button type="button" class="btn btn-danger" ng-click="deleteBrand(brand)"> Delete </button> <button type="button" class="btn btn-info"> <a href="#!/admin/auditLogReport?recordType=brands&recordId={{ brand.getId() }}">History</a> </button> </td> </tr> </tbody> </table>'),a.put("views/admin.editCategories.html",'<table class="table"> <thead> <tr> <th scope="col">Images</th> <th scope="col">Category</th> <th scope="col">Description </th> <th scope="col">Action</th> </tr> </thead> <tbody> <tr ng-repeat="category in categories"> <td> <img ng-if="!category.hasImage()" src="images/noimage.3b3d88bc.png" height="50px"> <img ng-if="category.hasImage()" ng-src="{{ category.getImage() }}" height="50px"> </td> <td>{{category.getName()}}</td> <td>{{category.getDescription()}}</td> <td class="action"> <button type="button" class="btn btn-success"> <a href="#!/admin/editCategory/{{ category.getId() }}">Edit</a> </button> <button type="button" class="btn btn-danger" ng-click="deleteCategory(category)"> Delete </button> <button type="button" class="btn btn-info"> <a href="#!/admin/auditLogReport?recordType=categories&recordId={{ category.getId() }}">History</a> </button> </td> </tr> </tbody> </table>'),a.put("views/admin.editCategory.html",'<div> <br> <div class="add-form" id="add-form"> <h2>Edit Item {{ itemType }}</h2> <div class="form-group"> Name: <input type="text" class="form-control" rows="5" ng-value="name" ng-model="NameValue" required> </div> <div class="form-group"> Description: <textarea type="textarea" class="form-control" rows="5" ng-value="description" placeholder="Description" ng-model="DescriptionValue" required></textarea> </div> <div class="form-group"> Parent Category: <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedParentCategoryName || parentCategory.name || \'Select Parent Category\'}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="category in categories" ng-if="category.getName().length > 0" ng-click="setParentCategory(category)" class="dropdown-item form-control"> {{category.getName()}} </button> </div> <div class="edit-form-btn"> <button class="btn btn-danger edit-form-btn" ng-click="removeParentCategory()"> Clear parent category selection </button> </div> </div> <div class="form-group"> Image: <img ng-if="!image" src="images/noimage.3b3d88bc.png" height="100px"> <img ng-if="image" ng-src="{{ image }}" height="100px"> <input id="pictures" type="submit" ngf-select ng-model="Image" name="file" value="Edit Image" accept="image/*" ngf-max-size="2MB" ngf-keep="true" ngf-keep-distinct="true" class="btn image-upload" required> </div> <div class="errorMessage" ng-if="errorMessage">Error submitting form. Please complete all fields to continue. <br> <br> </div> <input class="btn btn-primary btn-lg btn-block" type="submit" ng-click="processForm()" value="Submit"> </div> </div>'),a.put("views/admin.editProduct.html",'<div> <br> <div class="add-form" id="add-form"> <h2>Edit Product</h2> <div class="form-group"> Name: <input type="text" class="form-control" rows="5" ng-value="name" ng-model="NameValue" required> </div> <div class="form-group"> Description: <textarea type="textarea" class="form-control" rows="5" ng-value="description" placeholder="Description" ng-model="DescriptionValue" required></textarea> </div> <div class="form-group"> PurchaseURL : <input type="text" class="form-control" rows="5" ng-value="purchaseURL" ng-model="PurchaseURLValue" required> </div> <div class="form-group"> Image: <img ng-if="!image" src="images/noimage.3b3d88bc.png" height="100px"> <img ng-if="image" ng-src="{{ image }}" height="100px"> <input id="pictures" type="submit" ngf-select ng-model="Image" name="file" value="Edit Image" accept="image/*" ngf-max-size="2MB" ngf-keep="true" ngf-keep-distinct="true" class="btn image-upload" required> </div> <div class="form-group"> Category: <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedCategoryName || cat.name}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="category in categories" ng-if="category.name.length > 0" ng-click="setCategory(category)" class="dropdown-item form-control">{{category.name}}</button> </div> </div> <div class="form-group"> Brand: <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedBrandName || brand.getName()}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="brand in brands" ng-if="brand.getName().length > 0" ng-click="setBrand(brand)" class="dropdown-item form-control">{{brand.getName()}}</button> </div> </div> <div class="errorMessage" ng-if="errorMessage">Error submitting form. Please complete all fields to continue. <br> <br> </div> <input class="btn btn-primary btn-lg btn-block" type="submit" ng-click="processForm()" value="Submit"> </div> </div>'),a.put("views/admin.editProducts.html",'<table class="table"> <thead> <tr> <th scope="col">Images</th> <th scope="col">Products</th> <th scope="col">Brands</th> <th scope="col">Category</th> <th scope="col">Description </th> <th scope="col">Action</th> </tr> </thead> <tbody> <tr ng-repeat="product in products"> <td> <img ng-if="!product.hasImage()" src="images/noimage.3b3d88bc.png" height="50px"> <img ng-if="product.hasImage()" ng-src="{{ product.getImage() }}" height="50px"> </td> <td>{{product.getName()}}</td> <td>{{getNameForBrandId(product.getBrandId())}}</td> <td>{{getNameForCategoryId(product.getCategoryId())}}</td> <td>{{product.getDescription()}}</td> <td class="action"> <button type="button" class="btn btn-success"> <a href="#!/admin/editProduct/{{ product.getId() }}">Edit</a> </button> <button type="button" class="btn btn-danger" ng-click="deleteProduct(product)"> Delete </button> <button type="button" class="btn btn-info"> <a href="#!/admin/auditLogReport?recordType=products&recordId={{ product.getId() }}">History</a> </button> </td> </tr> </tbody> </table>'),a.put("views/admin.formAdd.html",'<div ng-if="formType === \'\'"> <h2>Select Submission Type</h2> <br> <div class="select-item-type" ng-click="selectItemType(availableTypes.Categories)"> Category </div> <div class="select-item-type" ng-click="selectItemType(availableTypes.Brands)"> Brand </div> <div class="select-item-type" ng-click="selectItemType(availableTypes.Products)"> Product </div> </div> <div ng-if="formType !== \'\'"> <br> <div class="add-form" id="add-form"> <h2>Add New {{ itemType }}</h2> <div class="form-group"> <input type="text" class="form-control" rows="5" value="" placeholder="Name" ng-model="addItem.name" required> </div> <div class="form-group"> <textarea type="textarea" class="form-control" rows="5" value="" placeholder="Description" ng-model="addItem.description" required></textarea> </div> <div class="form-group" ng-if="formType === availableTypes.Products"> <input type="text" class="form-control" rows="5" value="" placeholder="Link to Product" ng-model="addItem.purchaseUrl" required> </div> <div class="dropdown form-group" ng-if="formType !== availableTypes.Categories"> <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedCategoryName || \'Select Category\'}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="category in categories" ng-if="category.name.length > 0" ng-click="setCategory(category)" class="dropdown-item form-control">{{category.name}}</button> </div> </div> <div class="dropdown form-group" ng-if="formType === availableTypes.Categories"> <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedParentCategoryName || \'Select Parent Category\'}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="category in categories" ng-if="category.name.length > 0" ng-click="setParentCategory(category)" class="dropdown-item form-control"> {{category.name}} </button> </div> </div> <div class="dropdown form-group" ng-if="formType === availableTypes.Products"> <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedBrandName || \'Select Brand\'}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="brand in brands" ng-if="brand.name.length > 0" ng-click="setBrand(brand)" class="dropdown-item form-control">{{brand.name}}</button> </div> </div> <div class="dropdown form-group" ng-if="formType === availableTypes.Brands"> <button class="btn btn-secondary dropdown-toggle dropdownbtn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> {{selectedRankName || \'Select Ranking\'}} </button> <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"> <button ng-repeat="rank in rankingOptions" ng-if="rank.length > 0" ng-click="setRanking(rank)" class="dropdown-item form-control">{{rank}}</button> </div> </div> <div class="form-group"> <input id="pictures" type="submit" ngf-select ng-model="addItem.image" name="file" value="Select Image" accept="image/*" ngf-max-size="2MB" ngf-keep="true" ngf-keep-distinct="true" class="btn image-upload" required> </div> <div class="errorMessage" ng-if="errorMessage">Error submitting form. Please complete all fields to continue.<br><br></div> <input class="btn btn-primary btn-lg btn-block" type="submit" ng-click="processForm(addItem)" value="Submit"> <div class="select-item-type cancel"> <button class="btn btn-secondary" ng-click="selectItemType(\'\')"> Change Submission Type </button> </div> </div> </div> <div id="submitted-form"> <h2>Submitted Successfully!</h2> <div class="select-item-type" ng-click="reloadPage()"> Add New Item </div> </div>'),a.put("views/admin.html",'<div class="admin"> <div id="navbar-container"> <h2>Admin</h2> <ul id="navbar"> <li><a ui-sref="admin">Dashboard</a></li> <li><a ui-sref="admin.editProducts">Products</a></li> <li><a ui-sref="admin.editBrands">Brands</a></li> <li><a ui-sref="admin.editCategories">Categories</a></li> <li><a ui-sref="admin.add">Add product, brand, or category</a></li> <li><a ui-sref="admin.users">Add an admin</a></li> <li><a ui-sref="admin.auditLogReport">Audit Logs</a></li> </ul> <div ng--show="currentUser" ng-controller="SessionsCtrl"> <a ng-click="logoutUser()" id="log-out-btn">Log out</a> </div> </div> <div class="main"> <ui-view> <h2 id="welcome"> Welcome to the admin dashboard! </h2> </ui-view> </div> </div>'),a.put("views/admin.users.html",'<h2>Create a new user</h2> <form name="newUserForm" ng-controller="UsersCtrl" ng-submit="createUser(credentials)"> <label for="email">Email:</label> <br> <input type="text" id="email" ng-model="credentials.email"> <br> <label for="password">Password:</label> <br> <input type="password" id="password" ng-model="credentials.password"> <br> <br> <button type="submit" class="btn btn-primary btn-lg">Create user</button> </form>'),a.put("views/auditLog/admin.auditLogReport.html",'<h2>Audit Log Reporter</h2> <p ng-if="auditLogs === null">Please wait while we load the data...</p> <div ng-if="auditLogs !== null"> <h3 class="filter-heading">Filters <span ng-click="toggleShowFilter()"><span ng-if="showFilters">Hide</span><span ng-if="!showFilters">Show</span></span></h3> <table id="results-table" ng-if="showFilters"> <tr> <td> <table class="results-table-section"> <thead> <tr> <th>Users</th> <th>Operation<br>Types</th> <th>Event Dates/times</th> </tr> </thead> <tbody> <tr> <td> <select ng-model="criteria.user" title="Select user" ng-change="refreshResults()"> <option value="">Select...</option> <option ng-if="filters.users.anon" value="anonymous">Anonymous</option> <option ng-if="filters.users.admins.length > 0" value="any-admin">Any admin</option> <option ng-repeat="username in filters.users.admins" value="admin${{ username }}">{{ username }}</option> </select> </td> <td> <select ng-model="criteria.operationType" title="Select operation type" ng-change="refreshResults()"> <option value="">Select...</option> <option ng-repeat="operationType in filters.operationTypes" value="{{ operationType }}">{{ operationType }}</option> </select> </td> <td> <div class="form-group date-time-container"> <div class="date-time input-group date"> <span class="prompt">From:</span> <input type="text" value="" class="date-time" data-is-from-date="1" readonly id="date-from"> </div> </div> <div class="form-group date-time-container"> <div class="date-time input-group date"> <span class="prompt">To:</span> <input type="text" value="" class="date-time" data-is-from-date="0" readonly id="date-to"> </div> </div> </td> </tr> </tbody> </table> </td> </tr> <tr> <td> <table class="results-table-section"> <thead> <tr> <th>Record Type</th> <th>Record Ids</th> <th>Fields</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td> <select ng-model="criteria.record.type" title="Select record type" ng-change="clearRecordSubFilters(); refreshResults()"> <option value="">Select...</option> <option ng-repeat="(recordType, children) in filters.records" value="{{ recordType }}">{{ recordType }}</option> </select> </td> <td> <select ng-model="criteria.record.id" title="Select record id" ng-change="refreshResults()"> <option value="">Select...</option> <option ng-repeat="recordId in filters.records[criteria.record.type].ids" value="{{ recordId }}">{{ recordId }}</option> </select> </td> <td> <select ng-model="criteria.record.column" title="Select field" ng-change="refreshResults()"> <option value="">Select...</option> <option ng-repeat="recordColumn in filters.records[criteria.record.type].columns" value="{{ recordColumn }}">{{ recordColumn }}</option> </select> </td> <td> <input type="text" value="" ng-model="criteria.field.value" ng-change="refreshResults()"> <br> <label>From<input type="radio" name="transition" ng-model="criteria.field.transition" value="from" ng-change="refreshResults()"></label> <label>To<input type="radio" name="transition" ng-model="criteria.field.transition" value="to" ng-change="refreshResults()"></label> <label>Either<input type="radio" name="transition" ng-model="criteria.field.transition" value="either" ng-change="refreshResults()"></label> </td> </tr> </tbody> </table> </td> </tr> </table> <script ng-if="showFilters">var scope = angular.element(document.getElementById(\'results-table\')).scope();\n      $(document).ready(\n        function() {\n          $("input.date-time")\n            .each(\n              function () {\n                var isFromDate = $(this).data(\'isFromDate\');\n                $(this)\n                    .datetimepicker({\n                      format: \'DD-MMM-YYYY HH:mm\',\n                      showClear: true,\n                      showClose: true,\n                      ignoreReadonly: true,\n                      minDate: scope.getEarliestFilterDate ? scope.getEarliestFilterDate(isFromDate) : false,\n                      maxDate: (scope.getLatestFilterDate ? scope.getLatestFilterDate(isFromDate) : false)\n                    })\n                    .on(\n                      \'dp.change\',\n                      function (e) {\n                        // @TODO: We need to get this sorted - Angular doesn\'t seem to update the model when the user chooses a date.\n                        // @TODO: Nor does it fire the ng-change event thing.\n                        // @TODO: Currently, we\'re working around both those things.\n                        scope.criteria.dates.from = document.getElementById(\'date-from\').value;\n                        scope.criteria.dates.to = document.getElementById(\'date-to\').value;\n                        scope.refreshResults(true);\n                      }\n                    )\n                    // I have to do this because when "maxDate" is set (above), it actually puts the value in\n                    // the input field, which is not what we want.\n                    .val(null);\n              }\n            );\n        }\n      );</script> <h3>Matching</h3> <p ng-if="noFilter">Please enter some search criteria</p> <p ng-if="!noFilter && results.length === 0">No log entries match your criteria</p> <table ng-if="results.length > 0" class="matching-records"> <thead> <tr> <th ng-repeat="resultColumn in resultColumns" ng-bind-html="resultColumn.getHeading()"></th> </tr> </thead> <tbody> <tr ng-repeat-start="result in results" class="audit-log-results new-values"> <td ng-repeat="resultColumn in resultColumns" ng-class="resultColumn.getClass()" rowspan="{{ resultColumn.getRowSpan(true) }}" ng-bind-html="resultColumn.getDisplayValue(result, true, dataRepository)"> </td> </tr> <tr ng-repeat-end class="audit-log-results old-values"> <td ng-repeat="resultColumn in resultColumns" ng-class="resultColumn.getClass()" ng-if="resultColumn.isCellDisplayed(false)" ng-bind-html="resultColumn.getDisplayValue(result, false, dataRepository)"> </td> </tr> </tbody> </table> </div>'),
a.put("views/brand.html",'<div ng-if="!brandDetails"> <div class="col-md-12 thumbnail"> No Brand Details Found </div> </div> <div ng-if="brandDetails"> <div class="col-md-12 thumbnail"> <br> <div class="col-md-4"> <img ng-if="!brandDetails.hasImage()" src="images/noimage.3b3d88bc.png" height="400px" class="img-rounded img-responsive"> <img ng-if="brandDetails.hasImage()" ng-src="{{ brandDetails.getImage() }}" height="400px" class="img-rounded img-responsive"> </div> <div class="col-md-8"> <h2>{{ brandDetails.getName() }}</h2> <p ng-if="brandDetails.hasRanking()">Ranking: <a href="#!/rankings">{{ brandDetails.getRanking() }}</a></p> <p ng-if="relatedCategories.length > 0">Category: <span ng-repeat="categoryDetails in relatedCategories"> <a href="#!/category/{{ categoryDetails.getId() }}">{{ categoryDetails.getName() }}{{$last ? \'\' : \', \'}}</a> </span> </p> <p ng-if="brandDetails.hasDescription()">{{ brandDetails.getDescription() }}</p>  <a ng-if="brandDetails.hasBrandURL()" href="{{ brandDetails.getBrandURL() }}" class="btn purchaseButton" target="_blank"> Visit {{ brandDetails.getName() }} </a> </div> <br>&nbsp;<br> <div class="col-md-12"> <div class="row"><br> </div> </div> </div> <div class="" ng-if="loaded"> <h2>Products</h2> <div class="row"> <div ng-repeat="product in brandProducts"> <div class="col-sm-6 col-md-4"> <div class="thumbnail productblock"> <img ng-if="!product.hasImage()" src="images/noimage.3b3d88bc.png" height="400px"> <img ng-if="product.hasImage()" ng-src="{{ product.getImage() }}" height="400px"> <h3><a href="#!/product/{{ product.getId() }}">{{ product.getName() }}</a></h3> </div> </div> </div> </div> </div> <div class="" ng-if="!loaded || brandProducts.length == 0"> <p>No products found at this time</p> <p>&nbsp;</p> </div> </div>'),a.put("views/categories.html",'<h2>Shop All Categories</h2> <div ng-if="allCategories.length < 1"> Error: No Categories Found </div> <div class="" ng-if="loaded && allCategories.length > 0"> <div class="row"> <div ng-repeat="category in allCategories"> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <img ng-if="!category.hasImage()" src="images/noimage.3b3d88bc.png"> <img ng-if="category.hasImage()" ng-src="{{ category.getImage() }}"> <h3 class="category-title"><a href="#!/category/{{ category.getId() }}">{{ category.getName() }}</a></h3> </div> </div> </div> </div> </div>'),a.put("views/category.html",'<div ng-if="!categoryDetails"> <div class="col-md-12 thumbnail"> No Category Details Found </div> </div> <div ng-if="categoryDetails"> <div class="col-md-12 thumbnail"> <br> <div class="col-md-4"> <img ng-if="!categoryDetails.hasImage()" src="images/noimage.3b3d88bc.png" height="400px" class="img-rounded img-responsive"> <img ng-if="categoryDetails.hasImage()" ng-src="{{ categoryDetails.getImage() }}" height="400px" class="img-rounded img-responsive"> </div> <div class="col-md-8"> <p> <h2>{{ categoryDetails.getName() }}</h2> </p><p ng-if="categoryDetails.getDescription()">{{ categoryDetails.getDescription() }}</p>  </div> <br>&nbsp;<br> <div class="col-md-12"> <div class="row"><br> </div> </div> </div> <div class="" ng-if="loaded && relatedCategories.length > 0"> <div class="row"> <h2>Related Categories</h2> <div ng-repeat="category in relatedCategories"> <div class="col-sm-6 col-md-4"> <div class="thumbnail productblock"> <img ng-if="!category.hasImage()" src="images/noimage.3b3d88bc.png" height="400px"> <img ng-if="category.hasImage()" ng-src="{{ category.getImage() }}" height="400px"> <h3><a href="#!/category/{{ category.getId() }}">{{ category.getName() }}</a></h3> </div> </div> </div> </div> </div> <div class="" ng-if="loaded && categoryBrands.length > 0"> <div class="row"> <h2>Related Brands</h2> <div ng-repeat="brand in categoryBrands"> <div class="col-sm-6 col-md-4"> <div class="thumbnail productblock"> <img ng-if="!brand.hasImage()" src="images/noimage.3b3d88bc.png" height="400px"> <img ng-if="brand.hasImage()" ng-src="{{ brand.getImage() }}" height="400px"> <h3><a href="#!/brand/{{ brand.getId() }}">BOOM {{ brand.getName() }}</a></h3> </div> </div> </div> </div> </div> <div class="" ng-if="loaded && categoryProducts.length > 0"> <div class="row"> <h2>Related Products</h2> <div ng-repeat="product in categoryProducts"> <div class="col-sm-6 col-md-4"> <div class="thumbnail productblock"> <img ng-if="!product.hasImage()" src="images/noimage.3b3d88bc.png" height="400px"> <img ng-if="product.hasImage()" ng-src="{{ product.getImage() }}" height="400px"> <h3><a href="#!/product/{{ product.getId() }}">{{ product.getName() }}</a></h3> </div> </div> </div> </div> </div> <div class="" ng-if="!loaded || brandProducts.length == 0"> No products found at this time </div> </div>'),a.put("views/certifications.html",'<h2>Certifications</h2> <h3>Fair Trade</h3> <p>There are quite a few fair trade certifications and labels in the marketplace. Organizations that grant these certifications vary in their economic, social, governance and environmental standards as well as their inspecting, certifying and auditing policies. However, as a whole, fair trade certifications indicate that producers are paid a fair price for their goods; workers receive fair wages and work in good conditions; and there are no instances of forced, bonded or child labor throughout their supply chains. Third-party auditors conduct inspections to ensure that members of these fair trade organizations are in compliance.</p> <p>Though a food product may be fair trade certified, there are still ingredients such as milk, vegetable fat, emulsifiers and flavorings in it that can’t be sourced through fair trade. Some of our product suggestions only have one certified ingredient. Products from companies and brands in our Best category have a higher total percentage of fair trade sourced ingredients.</p> <div ng-if="!loaded"> <div class="col-md-12 thumbnail"> Error: No Certifications Found </div> </div> <div ng-if="loaded"> <div class="" ng-if="loaded && certifications.length > 0"> <div class="row"> <div ng-repeat="cert in certifications"> <div ng-if="cert != null"> <div class="col-sm-6 col-md-6"> <div class="thumbnail"> <h3>{{ cert.getName() }}</h3> <p>{{ cert.getDescription() }}</p> <img ng-if="!cert.hasImage()" src="images/noimage.3b3d88bc.png" height="200px"> <img ng-if="cert.hasImage()" ng-src="{{ cert.getImage() }}" height="200px"> </div> </div> </div> </div> </div> </div> </div>'),a.put("views/login.html",'<h2>Login</h2> <form name="loginForm" ng-controller="SessionsCtrl" ng-submit="loginUser(credentials)"> <label for="email">Email:</label> <br> <input type="text" id="email" ng-model="credentials.email"> <br> <label for="password">Password:</label> <br> <input type="password" id="password" ng-model="credentials.password"> <br> <br> <button type="submit" class="btn btn-primary btn-lg">Log in</button> </form>'),a.put("views/main.html",'<div class="col-md-12"> <img src="images/smarterconsumer.0cc1aa2c.jpg" width="100%"> </div> <div class="col-md-12 text-center"> <h1>Slave Free Buying Guide</h1> <div class="thumbnail"> <p>One of the most impactful ways everyday people can get involved in the fight against modern-day slavery and human trafficking is to begin purchasing slavery-free goods. When scaled, these purchases create demand for goods produced with audited, slavery-free labor; simultaneously, this shift also shrinks the market for goods produced with forced or slave labor. Search for products below or browse by category.</p> </div> </div> <div class="" ng-if="loaded"> <div class="row"> <h2><a href="#!/categories">View Categories</a></h2> <div ng-repeat="category in categories"> <div class="col-sm-6 col-md-4"> <div class="thumbnail productblock"> <img ng-if="!category.hasImage()" src="images/noimage.3b3d88bc.png" height="400px"> <img ng-if="category.hasImage()" ng-src="{{ category.getImage() }}" height="400px"> <h3><a href="#!/category/{{ category.getId() }}">{{ category.getName() }}</a></h3> </div> </div> </div> </div> </div>'),a.put("views/product.html",'<div ng-if="!brandDetails"> <div class="col-md-12 thumbnail"> No Product Details Found </div> </div> <div ng-if="brandDetails"> <div class="col-md-12 thumbnail"> <br> <div class="col-md-4"> <img ng-if="!productDetails.hasImage()" src="images/noimage.3b3d88bc.png" height="400px" class="img-rounded img-responsive"> <img ng-if="productDetails.hasImage()" ng-src="{{ productDetails.getImage() }}" height="400px" class="img-rounded img-responsive"> </div> <div class="col-md-8"> <h2>{{ productDetails.getName() }}</h2> <p ng-if="brandDetails.hasName()">Brand: <a href="#!/brand/{{ productDetails.getBrandId() }}">{{ brandDetails.getName() }}</a></p> <p ng-if="categoryDetails.hasName()">Category: <a href="#!/category/{{ productDetails.getCategoryId() }}">{{ categoryDetails.getName() }}</a></p> <p ng-if="productDetails.hasDescription()">{{ productDetails.getDescription() }}</p> <a ng-if="productDetails.hasPurchaseUrl()" ng-click="updateClickCount()" href="{{ productDetails.getPurchaseUrl() }}" class="btn purchaseButton" target="_blank" height="200px"> Purchase {{productDetails.getName() }} </a> </div> <br>&nbsp;<br> <div class="col-md-12"> <div class="row"><br> </div> </div> </div> </div>'),a.put("views/rankings.html",'<div> <h2>Ranking System</h2> <div class="col-md-12 thumbnail"> <p> We ranked companies and brands based on their antislavery policies; supply chain transparency; third-party certifications; and engagement around slavery, forced labor and human trafficking. We awarded points for our Good, Better, Best lists as described below. </p> </div> <div class="col-md-6"> <div class="thumbnail"> <h3>Policy</h3> <img src="images/rankingone.66a9e2fd.png" class="img-circle col-md-3" width="25%"> <p>The company or brand has a Code of Conduct against human trafficking, slave labor, forced labor, child labor or bonded labor.</p> <br> </div> <div class="thumbnail"> <h3>Transparency</h3> <img src="images/rankingone.66a9e2fd.png" class="img-circle col-md-3" width="25%"> <p>The company or brand publicly discloses a list of its suppliers or factories.</p> <br><br> </div> <div class="thumbnail"> <h3>Engagement</h3> <img src="images/rankingone.66a9e2fd.png" class="img-circle col-md-3" width="25%"> <p>The company or brand reinvests in its source or production communities through development programs, projects or donations.</p> <br> </div> </div> <div> <div class="col-md-6"> <div class="thumbnail"> <h3>Third Party Certifications</h3> <div> <img src="images/rankingtwo.c7879d80.png" class="img-circle col-md-3" width="25%"><br> The company or brand is third-party certified. *For third-party certifications we looked at, view the certifications page. </div><br> <div> <div class=""> <img src="images/rankingone.66a9e2fd.png" class="img-circle col-md-3" width="25%"><br> The company or brand owns a third-party certified line. </div> </div><br> <div> <div class=""> <img src="images/rankinghalf.b8ba315b.png" class="img-circle col-md-3" width="25%"><br> The company or brand produces one third-party certified product. </div> </div><br> </div> </div> </div></div>')}]);